<!DOCTYPE html>
<html>
<head>
<script>
const form = document.getElementById("image-upload-form");
const url = "/api/ephemeral";
function uploadImage() {
    // Add the file to the image
    const files = document.querySelector('[type=file]').files;
    const formData = new FormData();
    
    var image = document.getElementById('image');
    //next line might be wrong
	// image.src = URL.createObjectURL(files[0]);
    
    for (let i=0; i < files.length; i++) {
        let file = files[i];
        formData.append('image', file);
    }
    fetch(
        url,
        {
            method: 'POST',
            body: formData,
        }
    ).then((response) => { 
        if (response.status == 200) {
            document.getElementById('error').innerHTML = "";
            return response.text().then((response_text) => {
                document.getElementById('code').innerHTML = response_text;
            });
        } else {
            document.getElementById('code').innerHTML = "";
            return response.text().then((response_text) => {
                console.log(response_text);
                document.getElementById('error').innerHTML = "Error: " + response_text;
            });
        }
    })
    ;
    return false;
  }
</script>
</head>
<body style="background-color:#F0FFFF;">
<center>
<h1>Math to Latex!</h1>

<form id="image-upload-form" name="myForm" onsubmit="return uploadImage()" method="post">
  <label for="img">Select image:</label>
  <input type="file" id="img" name="image" accept="image/*">
  <input type="submit">
</form>
<p> Your Image: <img id="image" width="200" </img></p>
<p> Your Latex Code: <span id="code"></span>

<div id="error"></div>
</center>
</body>
</html>
